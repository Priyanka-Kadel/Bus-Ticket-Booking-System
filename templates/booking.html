<!DOCTYPE html>
{% load static %}


<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket Booking</title>
    <link rel="stylesheet" href="{% static 'css/booking.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</head>

<body>
          <!--===== HEADER =====-->
          <header class="l-header">
            <nav class="nav bd-grid">
                <div>
                    <span class="nav__logo-first">Suva</span><span class="nav__logo-yatra">Yatra</span>
                </div>
    
                <div class="nav__menu" id="nav-menu">
                    <ul class="nav__list">
                        <li class="nav__item"><a href="#home" class="nav__link active">Home</a></li>
                        <li class="nav__item"><a href="#about" class="nav__link">About</a></li>
                        <li class="nav__item"><a href="#skills" class="nav__link">How to book tickets?</a></li>
                        <li class="nav__item"><a href="#work" class="nav__link">Interior</a></li>
                        <li class="nav__item"><a href="#contact" class="nav__link">Contact</a></li>
    
                        <li class="nav__item nav__social-icon"><a href="#"><i class="fab fa-facebook"></i></a></li>
                        <li class="nav__item nav__social-icon"><a href="#"><i class="fab fa-twitter"></i></a></li>
                        <li class="nav__item nav__social-icon"><a href="#"><i class="fab fa-instagram"></i></a></li>
                        <li class="nav__item nav__social-icon"><a href="#"><i class="fab fa-linkedin"></i></a></li>
                    </ul>
                </div>
    
                <div class="nav__toggle" id="nav-toggle">
                    <i class='bx bx-menu'></i>
                </div>
            </nav>
        </header>

        <!-- Grey panel for selection and date -->
        <div class="grey-panel">
            <!-- Selection container -->
            <div class="select-container">
                <form action="{% url 'route' %}" method='POST'>
                    {% csrf_token %}

                    <!-- Select box for 'From' --> 
                    <select class="custom-select" style="width: 200px; height: 47px; margin-left: 20px;  margin-top: 10px;" required
                        name="from_location">
                        <option value="" disabled selected hidden>From</option>
                        {% for route in locations %}
                        <option value="{{route}}">{{route}}</option>
                        {% endfor %}
                    </select>

                    <!-- Select box for 'To' -->
                    <select class="custom-select" style="width: 200px; height: 47px; margin-left: 100px;" required
                        name="to_location" >
                        <option value="" disabled selected hidden>To</option>
                        {% for route in locations %}
                        <option value="{{route}}">{{route}}</option>
                        {% endfor %}
                    </select>

                    <!-- Date input -->
                    <input type="date" id="departure_time" name="departure_time" class="custom-date" style="width: 200px; height: 47px; margin-left: 100px;" required>
                    <button class="search-button" type="submit">Search</button>
                </form>
            </div>
        </div>
<!-- Black panel below grey panel -->
        <div class="black-panel1" id="search-results-panel">
            {% if routes %}
                {% for route in routes %}
                    <a href="{% url 'seats' route.id %}" class="route-info" title="Click to view details">
                        <p class="panel-text p1"><strong>Route Name:</strong> {{ route.route.route_name }}</p>
                        <p class="panel-text p3"><strong>Bus Number:</strong> {{ route.bus.bus_number }}</p>
                        <p class="panel-text p2"><strong>Location:</strong> {{ route.route.from_location }}-{{ route.route.to_location }}</p>
                        <p class="panel-text p4"><strong>Time:</strong> {{ route.departure_time }}</p>
                        <p class="panel-text p5"><strong>Total Seats:</strong> {{ route.bus.total_seat }}</p>
                        <p class="panel-text p6"><strong>Available Seats:</strong> {{ route.available_seats }}</p>
                        <p class="panel-text p7"><strong>Fare:</strong> {{ route.route.price }}</p>
                    </a>
                {% endfor %}
            {% else %}
                <p>No routes found.</p>
            {% endif %}
        </div>
        
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var searchResultsPanel = document.getElementById('search-results-panel');
            {% if routes %}
                searchResultsPanel.style.display = 'block';
            {% endif %}
        });
    </script>
</body>
</html>
